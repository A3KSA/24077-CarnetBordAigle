import{a as oe,b as se,c as ce}from"./chunk-6DRU2IZQ.js";import{a as ae,b as le,c as me,d as pe}from"./chunk-ULNO2TFJ.js";import{Aa as q,Ca as K,Da as U,Fa as Q,G as F,Ga as X,Ia as Y,Ja as ee,K as a,L as k,Oa as te,P as w,Pa as ne,Q as p,S as o,Sa as ie,T as r,U as x,V as T,Va as re,W as H,X as h,Y as f,Z as c,aa as P,ba as d,ca as B,ea as S,fa as I,ga as E,l as O,m as M,ma as D,o as V,oa as W,q as Z,qa as G,r as y,ra as z,sa as J,ta as $,v as u,w as _,x as v}from"./chunk-QDFYK3CP.js";import{a as R,b as j}from"./chunk-GAL4ENT6.js";function ge(n,l){if(n&1){let e=h();o(0,"button",20),f("click",function(){u(e);let t=c();return _(t.openModalNewUser())}),v(),o(1,"svg",21),x(2,"path",22)(3,"path",23)(4,"path",24),r(),d(5," Utilisateur "),r()}}function xe(n,l){if(n&1){let e=h();o(0,"button",20),f("click",function(){u(e);let t=c();return _(t.openModalNewNotebook())}),v(),o(1,"svg",14),x(2,"path",25),r(),d(3," Carnet "),r()}}function he(n,l){if(n&1){let e=h();o(0,"button",26),f("click",function(){u(e);let t=c();return _(t.toggleContent(!1))}),v(),o(1,"svg",14),x(2,"path",27),r(),d(3," Utilisateurs "),r()}}function Ce(n,l){if(n&1){let e=h();o(0,"button",26),f("click",function(){u(e);let t=c();return _(t.toggleContent(!0))}),v(),o(1,"svg",21),x(2,"path",28)(3,"path",29)(4,"path",30),r(),d(5," Carnets "),r()}}function we(n,l){if(n&1){let e=h();o(0,"div",31)(1,"input",32),E("ngModelChange",function(t){u(e);let s=c();return I(s.filterText,t)||(s.filterText=t),_(t)}),f("input",function(){u(e);let t=c();return _(t.applyFilters())}),r(),o(2,"div",33)(3,"label",34)(4,"input",35),E("ngModelChange",function(t){u(e);let s=c();return I(s.showPublic,t)||(s.showPublic=t),_(t)}),f("change",function(){u(e);let t=c();return _(t.applyFilters())}),r(),x(5,"span",36),r(),o(6,"div"),d(7,"public"),r()(),o(8,"div",33)(9,"label",34)(10,"input",35),E("ngModelChange",function(t){u(e);let s=c();return I(s.showPrivate,t)||(s.showPrivate=t),_(t)}),f("change",function(){u(e);let t=c();return _(t.applyFilters())}),r(),x(11,"span",36),r(),o(12,"div"),d(13,"priv\xE9"),r()()()}if(n&2){let e=c();a(),S("ngModel",e.filterText),a(3),S("ngModel",e.showPublic),a(6),S("ngModel",e.showPrivate)}}function be(n,l){if(n&1){let e=h();o(0,"app-notebook-item",41),f("notebookDeleted",function(t){u(e);let s=c(3);return _(s.onNotebookDeleted(t))}),r()}if(n&2){let e=l.$implicit;p("notebook",e)}}function ve(n,l){if(n&1&&(T(0),o(1,"div"),d(2,"Liste des carnets d'exploitations"),r(),o(3,"div",39),w(4,be,1,1,"app-notebook-item",40),r(),H()),n&2){let e=c(2);a(4),p("ngForOf",e.notebooks)}}function ke(n,l){if(n&1){let e=h();o(0,"app-user-item",43),f("userDeleted",function(t){u(e);let s=c(3);return _(s.onUserDeleted(t))}),r()}if(n&2){let e=l.$implicit;p("user",e)}}function Me(n,l){if(n&1&&(o(0,"div"),d(1,"Liste des utilisateurs"),r(),w(2,ke,1,1,"app-user-item",42)),n&2){let e=c(2);a(2),p("ngForOf",e.users)}}function ye(n,l){if(n&1&&(o(0,"div",37),w(1,ve,5,1,"ng-container",38)(2,Me,3,1,"ng-template",null,0,D),r()),n&2){let e=P(3),i=c();a(),p("ngIf",i.showNotebooks)("ngIfElse",e)}}function Se(n,l){if(n&1){let e=h();T(0),o(1,"div"),d(2,"Aucun carnet pour l'instant"),r(),o(3,"button",20),f("click",function(){u(e);let t=c(2);return _(t.openModalNewNotebook())}),v(),o(4,"svg",14),x(5,"path",25),r(),d(6," Premier carnet "),r(),H()}}function Ie(n,l){if(n&1){let e=h();o(0,"app-user-item",43),f("userDeleted",function(t){u(e);let s=c(3);return _(s.onUserDeleted(t))}),r()}if(n&2){let e=l.$implicit;p("user",e)}}function Ee(n,l){if(n&1&&(o(0,"div"),d(1,"Liste des utilisateurs"),r(),w(2,Ie,1,1,"app-user-item",42)),n&2){let e=c(2);a(2),p("ngForOf",e.users)}}function Ae(n,l){if(n&1&&(o(0,"div",44),w(1,Se,7,0,"ng-container",38)(2,Ee,3,1,"ng-template",null,0,D),r()),n&2){let e=P(3),i=c();a(),p("ngIf",i.showNotebooks)("ngIfElse",e)}}var de=(()=>{class n{userService;notebookService;route;dialog;router;user=[];allNotebooks=[];formattedNotebooks=[];notebooks=[];showPrivate=!0;showPublic=!0;filterText="";isMobile=!1;showNotebooks=!0;users=[];constructor(e,i,t,s,g){this.userService=e,this.notebookService=i,this.route=t,this.dialog=s,this.router=g}ngOnInit(){this.user._id=this.route.snapshot.paramMap.get("id"),this.getAllNotebooks(),this.getAllUsers(),this.userService.getUserById(this.user._id).subscribe({next:e=>{this.user=e,console.log("Utilisateur connect\xE9: ",e)}})}getAllNotebooks(){this.notebookService.getNotebook().subscribe({next:e=>{this.allNotebooks=e,this.formatNotebooks(),this.applyFilters()},error:e=>{console.log(e)}})}formatNotebooks(){this.formattedNotebooks=this.allNotebooks.map(e=>{let i=new Date(e.createdAt).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return j(R({},e),{createdAt:i})})}applyFilters(){this.notebooks=this.formattedNotebooks.filter(e=>{let i=this.showPrivate&&e.visibility==="private"||this.showPublic&&e.visibility==="public",t=e.title.toLowerCase().includes(this.filterText.toLowerCase());return i&&t})}getAllUsers(){this.userService.getUsers().subscribe({next:e=>{this.users=e},error:e=>{console.log(e)}})}onNotebookDeleted(e){this.notebooks=this.notebooks.filter(i=>i._id!==e)}onUserDeleted(e){this.users=this.users.filter(i=>i._id!==e)}openModalNewNotebook(){this.dialog.open(le,{autoFocus:!1}).afterClosed().subscribe(i=>{i&&this.getAllNotebooks()})}openModalNewUser(){this.dialog.open(se,{autoFocus:!1}).afterClosed().subscribe(i=>{i&&this.getAllUsers()})}logout(){this.userService.logout(),this.router.navigate(["/login"])}toggleContent(e){e===!1?this.getAllUsers():this.getAllNotebooks(),this.showNotebooks=e}static \u0275fac=function(i){return new(i||n)(k(ne),k(ae),k(q),k(re),k(K))};static \u0275cmp=Z({type:n,selectors:[["app-home"]],decls:25,vars:8,consts:[["usersList",""],[1,"container"],[1,"header"],[1,"titre1"],["src","/img/logo.png","alt","Image",1,"resized-image"],[1,"titre"],[1,"titre2"],[1,"container-infoUser"],[1,"texte"],[1,"user"],[1,"container-actions"],["class","action",3,"click",4,"ngIf"],["class","switch",3,"click",4,"ngIf"],[1,"logout",3,"click"],["xmlns","http://www.w3.org/2000/svg","id","Layer_1","data-name","Layer 1","viewBox","0 0 24 24"],["d","M11.5,16A1.5,1.5,0,0,0,10,17.5v.8A2.7,2.7,0,0,1,7.3,21H5.7A2.7,2.7,0,0,1,3,18.3V5.7A2.7,2.7,0,0,1,5.7,3H7.3A2.7,2.7,0,0,1,10,5.7v.8a1.5,1.5,0,0,0,3,0V5.7A5.706,5.706,0,0,0,7.3,0H5.7A5.706,5.706,0,0,0,0,5.7V18.3A5.706,5.706,0,0,0,5.7,24H7.3A5.706,5.706,0,0,0,13,18.3v-.8A1.5,1.5,0,0,0,11.5,16Z"],["d","M22.561,9.525,17.975,4.939a1.5,1.5,0,0,0-2.121,2.122l3.411,3.411L7,10.5a1.5,1.5,0,0,0,0,3H7l12.318-.028-3.467,3.467a1.5,1.5,0,0,0,2.121,2.122l4.586-4.586A3.505,3.505,0,0,0,22.561,9.525Z"],["class","container-filtres",4,"ngIf"],["class","content",4,"ngIf"],["class","content-vide",4,"ngIf"],[1,"action",3,"click"],["xmlns","http://www.w3.org/2000/svg","id","Outline","viewBox","0 0 24 24"],["d","M23,11H21V9a1,1,0,0,0-2,0v2H17a1,1,0,0,0,0,2h2v2a1,1,0,0,0,2,0V13h2a1,1,0,0,0,0-2Z"],["d","M9,12A6,6,0,1,0,3,6,6.006,6.006,0,0,0,9,12ZM9,2A4,4,0,1,1,5,6,4,4,0,0,1,9,2Z"],["d","M9,14a9.01,9.01,0,0,0-9,9,1,1,0,0,0,2,0,7,7,0,0,1,14,0,1,1,0,0,0,2,0A9.01,9.01,0,0,0,9,14Z"],["d","M.485,8.088l9.862,5.917c.51,.306,1.081,.459,1.653,.459,.571,0,1.143-.153,1.653-.459l9.861-5.917c.301-.181,.485-.506,.485-.857s-.184-.677-.485-.857L13.654,.456c-1.021-.613-2.287-.613-3.307,0L.485,6.373c-.301,.181-.485,.506-.485,.857s.184,.677,.485,.857ZM11.376,2.171h0c.384-.23,.863-.23,1.248,0l8.432,5.06-8.432,5.06c-.385,.23-.864,.23-1.249,0L2.944,7.23,11.376,2.171Zm12.624,17.829c0,.553-.448,1-1,1h-2v2c0,.553-.448,1-1,1s-1-.447-1-1v-2h-2c-.552,0-1-.447-1-1s.448-1,1-1h2v-2c0-.553,.448-1,1-1s1,.447,1,1v2h2c.552,0,1,.447,1,1Zm-11.143,3.286c-.188,.312-.519,.485-.858,.485-.175,0-.353-.046-.514-.143L.485,17.029c-.474-.284-.627-.898-.343-1.372,.283-.474,.897-.628,1.372-.343l11,6.6c.474,.284,.627,.898,.343,1.372Zm11-12.196c.284,.474,.131,1.088-.343,1.372l-11,6.6c-.159,.095-.336,.143-.515,.143s-.356-.048-.515-.143L.485,12.462c-.474-.284-.627-.898-.343-1.372,.283-.475,.897-.628,1.372-.343l10.485,6.291,10.485-6.291c.474-.284,1.088-.131,1.372,.343Z"],[1,"switch",3,"click"],["d","M12,16a4,4,0,1,1,4-4A4,4,0,0,1,12,16Zm0-6a2,2,0,1,0,2,2A2,2,0,0,0,12,10Zm6,13A6,6,0,0,0,6,23a1,1,0,0,0,2,0,4,4,0,0,1,8,0,1,1,0,0,0,2,0ZM18,8a4,4,0,1,1,4-4A4,4,0,0,1,18,8Zm0-6a2,2,0,1,0,2,2A2,2,0,0,0,18,2Zm6,13a6.006,6.006,0,0,0-6-6,1,1,0,0,0,0,2,4,4,0,0,1,4,4,1,1,0,0,0,2,0ZM6,8a4,4,0,1,1,4-4A4,4,0,0,1,6,8ZM6,2A2,2,0,1,0,8,4,2,2,0,0,0,6,2ZM2,15a4,4,0,0,1,4-4A1,1,0,0,0,6,9a6.006,6.006,0,0,0-6,6,1,1,0,0,0,2,0Z"],["d","M22.485,10.975,12,17.267,1.515,10.975A1,1,0,1,0,.486,12.69l11,6.6a1,1,0,0,0,1.03,0l11-6.6a1,1,0,1,0-1.029-1.715Z"],["d","M22.485,15.543,12,21.834,1.515,15.543A1,1,0,1,0,.486,17.258l11,6.6a1,1,0,0,0,1.03,0l11-6.6a1,1,0,1,0-1.029-1.715Z"],["d","M12,14.773a2.976,2.976,0,0,1-1.531-.425L.485,8.357a1,1,0,0,1,0-1.714L10.469.652a2.973,2.973,0,0,1,3.062,0l9.984,5.991a1,1,0,0,1,0,1.714l-9.984,5.991A2.976,2.976,0,0,1,12,14.773ZM2.944,7.5,11.5,12.633a.974.974,0,0,0,1,0L21.056,7.5,12.5,2.367a.974.974,0,0,0-1,0h0Z"],[1,"container-filtres"],["placeholder","Rechercher...",1,"input-filtres",3,"ngModelChange","input","ngModel"],[1,"checkbox"],[1,"checkbox-container"],["checked","","type","checkbox",1,"custom-checkbox",3,"ngModelChange","change","ngModel"],[1,"checkmark"],[1,"content"],[4,"ngIf","ngIfElse"],[1,"listCarnets"],[3,"notebook","notebookDeleted",4,"ngFor","ngForOf"],[3,"notebookDeleted","notebook"],[3,"user","userDeleted",4,"ngFor","ngForOf"],[3,"userDeleted","user"],[1,"content-vide"]],template:function(i,t){i&1&&(o(0,"div",1)(1,"div",2)(2,"div",3),x(3,"img",4),o(4,"div",5),d(5,"STEP Aigle"),r()(),o(6,"div",6),d(7,"Carnet de bord"),r(),o(8,"div",7)(9,"div",8),d(10,"Bienvenu"),r(),o(11,"div",9),d(12),r()(),o(13,"div",10),w(14,ge,6,0,"button",11)(15,xe,4,0,"button",11)(16,he,4,0,"button",12)(17,Ce,6,0,"button",12),o(18,"button",13),f("click",function(){return t.logout()}),v(),o(19,"svg",14),x(20,"path",15)(21,"path",16),r()()()(),w(22,we,14,3,"div",17)(23,ye,4,2,"div",18)(24,Ae,4,2,"div",19),r()),i&2&&(a(12),B(t.user.name),a(2),p("ngIf",!t.showNotebooks),a(),p("ngIf",t.showNotebooks&&t.notebooks.length!=0),a(),p("ngIf",t.showNotebooks&&t.user.role!="exploitant"),a(),p("ngIf",!t.showNotebooks),a(5),p("ngIf",t.showNotebooks),a(),p("ngIf",t.notebooks.length!=0),a(),p("ngIf",t.notebooks.length===0))},dependencies:[G,z,X,Q,Y,ee,me,oe],styles:[".titre1[_ngcontent-%COMP%]{padding-top:10px;display:flex;flex-direction:row;gap:10px;justify-content:center;align-items:center}.titre2[_ngcontent-%COMP%]{font-size:20px;font-weight:600;text-transform:uppercase}.container-infoUser[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:5px;justify-content:center;align-items:center}.container-infoUser[_ngcontent-%COMP%]   .texte[_ngcontent-%COMP%]{font-size:18px}.user[_ngcontent-%COMP%]{font-size:18px;font-weight:600}.content[_ngcontent-%COMP%]{padding:10px;width:95%;display:flex;flex-direction:column;gap:10px;justify-content:center;align-items:center;overflow-y:auto}.listCarnets[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:10px;justify-content:center;align-items:center;flex-wrap:wrap}.content-vide[_ngcontent-%COMP%]{width:95%;display:flex;flex-direction:column;gap:10px;justify-content:flex-start;align-items:center;overflow-y:auto;padding:10px 5px;height:100%}.ng-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;gap:10px;justify-content:center;align-items:center}.container-filtres[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px;justify-content:center;align-items:center;background-color:#f0f8ff;width:100%;padding:10px 0}app-notebook-item[_ngcontent-%COMP%]{width:100%}app-user-item[_ngcontent-%COMP%]{width:100%}.checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;gap:5px}.logout[_ngcontent-%COMP%]{background-color:#960303;color:#fff;width:auto}.logout[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:14px;fill:#fff}@media (min-width: 1000px){.listCarnets[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;gap:20px;justify-content:center;align-items:center;flex-wrap:wrap}app-notebook-item[_ngcontent-%COMP%]{width:30%}}@media (min-width: 1500px){.listCarnets[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;gap:20px;justify-content:center;align-items:center;flex-wrap:wrap}app-notebook-item[_ngcontent-%COMP%]{width:19%}}"]})}return n})();var Ne=[{path:"",component:de}],ue=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=y({type:n});static \u0275inj=M({imports:[U.forChild(Ne),U]})}return n})();var _e=(()=>{class n{constructor(e,i){this.document=e,this.platformId=i,this.documentIsAccessible=$(this.platformId)}static getCookieRegExp(e){let i=e.replace(/([\[\]{}()|=;+?,.*^$])/gi,"\\$1");return new RegExp("(?:^"+i+"|;\\s*"+i+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(e){try{return decodeURIComponent(e)}catch{return e}}check(e){return this.documentIsAccessible?(e=encodeURIComponent(e),n.getCookieRegExp(e).test(this.document.cookie)):!1}get(e){if(this.documentIsAccessible&&this.check(e)){e=encodeURIComponent(e);let t=n.getCookieRegExp(e).exec(this.document.cookie);return t[1]?n.safeDecodeURIComponent(t[1]):""}else return""}getAll(){if(!this.documentIsAccessible)return{};let e={},i=this.document;return i.cookie&&i.cookie!==""&&i.cookie.split(";").forEach(t=>{let[s,g]=t.split("=");e[n.safeDecodeURIComponent(s.replace(/^ /,""))]=n.safeDecodeURIComponent(g)}),e}set(e,i,t,s,g,b,A,fe){if(!this.documentIsAccessible)return;if(typeof t=="number"||t instanceof Date||s||g||b||A){let N={expires:t,path:s,domain:g,secure:b,sameSite:A||"Lax",partitioned:fe};this.set(e,i,N);return}let C=encodeURIComponent(e)+"="+encodeURIComponent(i)+";",m=t||{};if(m.expires)if(typeof m.expires=="number"){let N=new Date(new Date().getTime()+m.expires*1e3*60*60*24);C+="expires="+N.toUTCString()+";"}else C+="expires="+m.expires.toUTCString()+";";m.path&&(C+="path="+m.path+";"),m.domain&&(C+="domain="+m.domain+";"),m.secure===!1&&m.sameSite==="None"&&(m.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${e} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),m.secure&&(C+="secure;"),m.sameSite||(m.sameSite="Lax"),C+="sameSite="+m.sameSite+";",m.partitioned&&(C+="Partitioned;"),this.document.cookie=C}delete(e,i,t,s,g="Lax"){if(!this.documentIsAccessible)return;let b=new Date("Thu, 01 Jan 1970 00:00:01 GMT");this.set(e,"",{expires:b,path:i,domain:t,secure:s,sameSite:g})}deleteAll(e,i,t,s="Lax"){if(!this.documentIsAccessible)return;let g=this.getAll();for(let b in g)g.hasOwnProperty(b)&&this.delete(b,e,i,t,s)}static{this.\u0275fac=function(i){return new(i||n)(V(W),V(F))}}static{this.\u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var st=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=y({type:n});static \u0275inj=M({providers:[_e],imports:[J,te,ie,ue,pe,ce]})}return n})();export{_e as a,st as b};
